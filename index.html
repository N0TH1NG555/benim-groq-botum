<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A.S.C.A Ai | Advanced System</title>
    
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><rect width=%22100%22 height=%22100%22 rx=%2220%22 fill=%22%23000000%22/><text y=%22.9em%22 x=%2250%22 text-anchor=%22middle%22 font-size=%2280%22 fill=%22%23ffffff%22>⌬</text></svg>">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['Space Grotesk', 'sans-serif'], mono: ['JetBrains Mono', 'monospace'] },
                    colors: { asca: { black: '#000000', dark: '#09090b', border: '#27272a', text: '#fafafa', silver: '#a1a1aa' } },
                    animation: { 'fade-in': 'fadeIn 0.6s ease-out forwards', 'slide-up': 'slideUp 0.6s ease-out forwards', 'spin-slow': 'spin 20s linear infinite' },
                    keyframes: {
                        fadeIn: { '0%': { opacity: '0' }, '100%': { opacity: '1' } },
                        slideUp: { '0%': { opacity: '0', transform: 'translateY(20px)' }, '100%': { opacity: '1', transform: 'translateY(0)' } }
                    }
                }
            }
        }
    </script>

    <style>
        body { background-color: #000; background-image: linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px), linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px); background-size: 50px 50px; color: #fafafa; }
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-thumb { background: #333; }
        .msg-user { background: #ffffff; color: #000; border-radius: 2px; }
        .msg-ai { background: #09090b; color: #e4e4e7; border: 1px solid #27272a; border-left: 2px solid #fff; border-radius: 2px; }
        .prose pre { background: #000 !important; border: 1px solid #333; padding: 10px; overflow-x: auto; }
        .status-dot { width: 6px; height: 6px; background: #333; border-radius: 50%; }
        .status-dot.active { background: #fff; box-shadow: 0 0 8px #fff; }
        .status-dot.loading { background: #eab308; animation: pulse 1s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
    </style>
</head>
<body class="h-screen flex flex-col font-sans overflow-hidden">

    <header class="h-20 border-b border-white/10 bg-black/90 backdrop-blur-md flex items-center justify-between px-6 z-20">
        <div class="flex items-center gap-5">
            <div class="w-12 h-12 border border-white/20 bg-black flex items-center justify-center animate-spin-slow">
                <span class="text-3xl text-white font-mono">⌬</span>
            </div>
            <div>
                <h1 class="text-2xl font-bold tracking-widest text-white font-mono leading-none">A.S.C.A</h1>
                <div class="flex items-center gap-2">
                    <span id="status-dot" class="status-dot active"></span>
                    <span id="status-text" class="text-[10px] text-zinc-500 font-mono">SYSTEM ONLINE</span>
                </div>
            </div>
        </div>
        <button onclick="location.reload()" class="text-zinc-600 hover:text-red-500 transition-colors">
            <i class="fa-solid fa-power-off"></i>
        </button>
    </header>

    <main class="flex-1 overflow-hidden relative flex flex-col">
        <div id="chat-container" class="flex-1 overflow-y-auto p-4 sm:p-8 space-y-6">
            <div id="welcome" class="h-full flex flex-col items-center justify-center text-center space-y-6">
                <span class="text-8xl opacity-10 font-mono">⌬</span>
                <h2 class="text-4xl font-bold">A.S.C.A <span class="text-zinc-700 text-xl">V0.1</span></h2>
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 w-full max-w-xl">
                    <button onclick="sendQuick('Sistem ne alemde bak bakalım kanka.')" class="p-4 border border-zinc-800 hover:border-white transition-all text-left bg-zinc-950">
                        <span class="block text-xs text-zinc-500 font-mono">INIT_01</span>
                        Durum Analizi Yap
                    </button>
                    <button onclick="sendQuick('Bana kuantum olayını anlat kanka.')" class="p-4 border border-zinc-800 hover:border-white transition-all text-left bg-zinc-950">
                        <span class="block text-xs text-zinc-500 font-mono">DATA_02</span>
                        Kuantum Nedir?
                    </button>
                </div>
            </div>
        </div>

        <div class="p-6 bg-black">
            <div class="max-w-4xl mx-auto border border-zinc-800 flex items-center p-2 gap-2 focus-within:border-white transition-all">
                <span class="text-zinc-600 font-mono text-xs pl-2">root@asca:~$</span>
                <input type="text" id="user-input" placeholder="Bir şeyler yaz kanka..." class="flex-1 bg-transparent outline-none p-2 font-mono text-sm">
                <button id="send-btn" onclick="sendMessage()" class="bg-white text-black px-4 py-2 hover:bg-zinc-300 transition-all disabled:opacity-50">
                    <i class="fa-solid fa-arrow-right"></i>
                </button>
            </div>
        </div>
    </main>

    <script>
        const chatContainer = document.getElementById('chat-container');
        const userInput = document.getElementById('user-input');
        const statusDot = document.getElementById('status-dot');
        const statusText = document.getElementById('status-text');
        
        // Önemli: API Key'i buraya yazma! Vercel Settings'den ekle.

        async function sendMessage() {
            const text = userInput.value.trim();
            if(!text) return;

            document.getElementById('welcome').style.display = 'none';
            userInput.value = '';
            
            // Kullanıcı mesajı
            appendMessage(text, 'user');
            
            // Düşünüyor efekti
            statusDot.className = 'status-dot loading';
            statusText.innerText = 'THINKING...';
            const typingDiv = appendMessage('...', 'ai');

            try {
                // VERCEL BACKEND'E İSTEK ATIYORUZ
                const response = await fetch('/api/chat', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ mesaj: text })
                });

                const data = await response.json();
                
                typingDiv.remove(); // Noktaları kaldır
                
                if(data.cevap) {
                    appendMessage(data.cevap, 'ai');
                    statusDot.className = 'status-dot active';
                    statusText.innerText = 'SYSTEM ONLINE';
                } else {
                    throw new Error(data.error || 'Bilinmeyen hata');
                }

            } catch (err) {
                typingDiv.innerText = "Hata oluştu: " + err.message;
                statusDot.className = 'status-dot error';
            }
        }

        function appendMessage(text, role) {
            const div = document.createElement('div');
            div.className = `flex ${role === 'user' ? 'justify-end' : 'justify-start'} animate-slide-up mb-4`;
            
            const inner = document.createElement('div');
            inner.className = `p-4 max-w-[80%] ${role === 'user' ? 'msg-user' : 'msg-ai prose prose-invert'}`;
            
            if(role === 'ai') {
                inner.innerHTML = marked.parse(text);
                inner.querySelectorAll('pre code').forEach(el => hljs.highlightElement(el));
            } else {
                inner.innerText = text;
            }
            
            div.appendChild(inner);
            chatContainer.appendChild(div);
            chatContainer.scrollTop = chatContainer.scrollHeight;
            return inner;
        }

        function sendQuick(t) { userInput.value = t; sendMessage(); }
        
        userInput.addEventListener('keypress', (e) => { if(e.key === 'Enter') sendMessage(); });
    </script>
</body>
</html>
